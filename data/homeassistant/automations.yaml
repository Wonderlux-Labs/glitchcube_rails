- id: '1755159655071'
  alias: Cube Light (voice)
  description: Voice assistant feedback lighting with scene restoration
  triggers:
  - trigger: state
    entity_id: assist_satellite.square_voice
    from: idle
    id: voice_activated
  - trigger: state
    entity_id: assist_satellite.square_voice
    to: listening
    id: listening
  - trigger: state
    entity_id: assist_satellite.square_voice
    to: processing
    id: processing
  - trigger: state
    entity_id: assist_satellite.square_voice
    to: speaking
    id: speaking
  - trigger: state
    entity_id: assist_satellite.square_voice
    to: idle
    for:
      seconds: 2
    id: voice_idle
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: voice_activated
      sequence:
      - action: scene.create
        data:
          scene_id: cube_voice_restore
          snapshot_entities:
          - light.cube_light
    - conditions:
      - condition: trigger
        id: listening
      sequence:
      - action: light.turn_on
        target:
          entity_id: light.cube_light
        data:
          rgb_color: '{{ listening_color }}'
          brightness_pct: 80
          transition: 0.3
  variables:
    listening_color:
    - 0
    - 255
    - 0
    processing_color:
    - 0
    - 0
    - 255
    speaking_color:
    - 128
    - 0
    - 128
  mode: parallel
- id: '1755164988353'
  alias: GPS - Current Cube Location
  description: ''
  triggers:
  - trigger: state
    entity_id: sensor.cube_current_location_text
  conditions:
  - condition: template
    value_template: "{{ trigger.to_state.state not in ['unknown', 'unavailable', ''] }}"
  actions:
  - action: input_text.set_value
    metadata: {}
    data:
      value: '{{ trigger.to_state.state }}'
    target:
      entity_id: input_text.current_location
  mode: single
- id: '1755313710558'
  alias: Persona Switcher
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - input_text.current_persona
    from:
    to:
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: state
        entity_id: input_text.current_persona
        state: jax
      sequence:
      - action: select.select_option
        data:
          option: JAX
        target:
          entity_id:
          - select.home_assistant_voice_09739d_assistant
          - select.esp32_s3_box_3_52b3dc_assistant
    - conditions:
      - condition: state
        entity_id: input_text.current_persona
        state: buddy
      sequence:
      - action: select.select_option
        data:
          option: BUDDY
        target:
          entity_id:
          - select.home_assistant_voice_09739d_assistant
          - select.esp32_s3_box_3_52b3dc_assistant
    - conditions:
      - condition: state
        entity_id: input_text.current_persona
        state: lomi
      sequence:
      - action: select.select_option
        data:
          option: LOMI
        target:
          entity_id:
          - select.home_assistant_voice_09739d_assistant
          - select.esp32_s3_box_3_52b3dc_assistant
    - conditions:
      - condition: state
        entity_id: input_text.current_persona
        state: zorp
      sequence:
      - action: select.select_option
        data:
          option: ZORP
        target:
          entity_id:
          - select.home_assistant_voice_09739d_assistant
          - select.esp32_s3_box_3_52b3dc_assistant
  mode: single
- id: '1755332428238'
  alias: Siren - Auto Off
  description: 'Auto turn off siren after 20 seconds'
  triggers:
  - trigger: state
    entity_id:
    - siren.small_siren
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 20
  conditions: []
  actions:
  - action: siren.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: siren.small_siren
  mode: single
- id: '1755332428239'
  alias: Fan - Auto Off
  description: 'Auto turn off fan after 1 minute'
  triggers:
  - trigger: state
    entity_id:
    - switch.fan_switch
    to: 'on'
    for:
      hours: 0
      minutes: 1
      seconds: 0
  conditions: []
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.fan_switch
  - action: input_boolean.turn_on
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.fan_cooldown
  mode: single
- id: '1755332428240'
  alias: Strobe - Auto Off
  description: 'Auto turn off strobe after 30 seconds'
  triggers:
  - trigger: state
    entity_id:
    - switch.strobe_switch
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 30
  conditions: []
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.strobe_switch
  mode: single
- id: '1755332428241'
  alias: Blacklight - Auto Off
  description: 'Auto turn off blacklight after 30 seconds'
  triggers:
  - trigger: state
    entity_id:
    - switch.blacklight_switch
    to: 'on'
    for:
      hours: 0
      minutes: 0
      seconds: 30
  conditions: []
  actions:
  - action: switch.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: switch.blacklight_switch
  mode: single
- id: '1755332428242'
  alias: Fan Cooldown Clear
  description: 'Clear fan cooldown after 1 hour'
  triggers:
  - trigger: state
    entity_id:
    - input_boolean.fan_cooldown
    to: 'on'
    for:
      hours: 1
      minutes: 0
      seconds: 0
  conditions: []
  actions:
  - action: input_boolean.turn_off
    metadata: {}
    data: {}
    target:
      entity_id: input_boolean.fan_cooldown
  mode: single
- id: '1755333596935'
  alias: Health - Lights Red
  description: ''
  triggers:
  - trigger: state
    entity_id:
    - sensor.backend_health_check
    to: unavailable
    for:
      hours: 0
      minutes: 0
      seconds: 15
  - trigger: state
    entity_id:
    - sensor.backend_health_check
    to: unknown
    for:
      hours: 0
      minutes: 0
      seconds: 15
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      rgb_color:
      - 99
      - 0
      - 0
      flash: long
    target:
      entity_id: light.cube_voice_ring
  - action: light.turn_on
    metadata: {}
    data:
      rgb_color:
      - 86
      - 0
      - 0
    target:
      entity_id: light.cart_light
  mode: single
- id: '1755333757049'
  alias: Health Healthy
  description: Health Healthy
  triggers:
  - trigger: state
    entity_id:
    - sensor.backend_health_check
    to: healthy
    for:
      hours: 0
      minutes: 0
      seconds: 15
    from: unavailable
  conditions: []
  actions:
  - action: light.turn_on
    metadata: {}
    data:
      rgb_color:
      - 0
      - 200
      - 0
      flash: long
    target:
      entity_id: light.cube_voice_ring
  - action: light.turn_on
    metadata: {}
    data:
      effect: twinkle
    target:
      entity_id: light.cart_light
  - delay:
      hours: 0
      minutes: 0
      seconds: 5
      milliseconds: 0
  - action: light.turn_on
    metadata: {}
    data:
      brightness_pct: 100
      rgb_color:
      - 116
      - 0
      - 100
    target:
      entity_id: light.cart_light
  - delay:
      hours: 0
      minutes: 0
      seconds: 30
      milliseconds: 0
  - action: light.turn_on
    metadata: {}
    data:
      effect: none
    target:
      entity_id: light.cart_light
  mode: single

- id: 'cycle_persona_automation'
  alias: "Cycle Persona Button"
  description: "Cycles through personas when button is pressed"
  triggers:
  - trigger: state
    entity_id: input_button.cycle_persona
  conditions: []
  actions:
  - action: rest_command.cycle_persona
  mode: single
